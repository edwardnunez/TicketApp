<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: frontend/src/pages/admin/components/ManualBlockingSelection.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: frontend/src/pages/admin/components/ManualBlockingSelection.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useMemo } from 'react';
import { Card, Select, InputNumber, Button, Typography, Alert, Tag, Space, notification, Switch } from 'antd';
import { LockOutlined, UnlockOutlined, StopOutlined } from '@ant-design/icons';
import { COLORS } from '../../../components/colorscheme';

const { Title, Text } = Typography;
const { Option } = Select;

/**
 * Componente de bloqueo manual de asientos mediante formulario
 * @param {Object} props - Propiedades del componente
 * @param {Object} props.seatMapData - Datos del mapa de asientos
 * @param {Array} props.blockedSeats - Asientos actualmente bloqueados
 * @param {Array} props.blockedSections - Secciones actualmente bloqueadas
 * @param {Function} props.onSeatToggle - Función para bloquear/desbloquear asientos
 * @param {Function} props.onSectionToggle - Función para bloquear/desbloquear secciones
 */
const ManualBlockingSelection = ({
  seatMapData,
  blockedSeats = [],
  blockedSections = [],
  onSeatToggle,
  onSectionToggle
}) => {
  const [selectedSection, setSelectedSection] = useState(null);
  const [selectedRow, setSelectedRow] = useState(null);
  const [selectedSeatNumber, setSelectedSeatNumber] = useState(null);
  const [blockingMode, setBlockingMode] = useState('seat'); // 'seat' o 'section'

  // Obtener información de la sección seleccionada
  const currentSection = useMemo(() => {
    if (!seatMapData || !selectedSection) return null;
    return seatMapData.sections.find(s => s.id === selectedSection);
  }, [selectedSection, seatMapData]);

  if (!seatMapData) return null;

  const { sections } = seatMapData;

  // Verificar si la sección está bloqueada
  const isSectionBlocked = (sectionId) => {
    return blockedSections &amp;&amp; blockedSections.includes(sectionId);
  };

  // Verificar si el asiento está bloqueado
  const isSeatBlocked = (sectionId, row, seat) => {
    const seatId = `${sectionId}-${row}-${seat}`;
    return blockedSeats.includes(seatId);
  };

  // Manejar cambio de sección
  const handleSectionChange = (sectionId) => {
    setSelectedSection(sectionId);
    setSelectedRow(null);
    setSelectedSeatNumber(null);
  };

  // Bloquear/Desbloquear asiento
  const handleToggleSeat = () => {
    if (!currentSection) {
      notification.warning({
        message: 'Selección incompleta',
        description: 'Por favor, selecciona una sección.',
        placement: 'topRight'
      });
      return;
    }

    // Si es entrada general, usar el handler de sección
    if (!currentSection.hasNumberedSeats) {
      notification.info({
        message: 'Entrada General',
        description: 'Para secciones de entrada general, usa el modo "Bloquear sección completa".',
        placement: 'topRight'
      });
      return;
    }

    // Para asientos numerados
    if (!selectedRow || !selectedSeatNumber) {
      notification.warning({
        message: 'Selección incompleta',
        description: 'Por favor, selecciona fila y asiento.',
        placement: 'topRight'
      });
      return;
    }

    const seatId = `${currentSection.id}-${selectedRow}-${selectedSeatNumber}`;
    const isCurrentlyBlocked = blockedSeats.includes(seatId);

    onSeatToggle(seatId);

    notification.success({
      message: isCurrentlyBlocked ? 'Asiento desbloqueado' : 'Asiento bloqueado',
      description: `${currentSection.name} - Fila ${selectedRow}, Asiento ${selectedSeatNumber}`,
      placement: 'topRight',
      icon: isCurrentlyBlocked ? &lt;UnlockOutlined style={{ color: '#52c41a' }} /> : &lt;LockOutlined style={{ color: '#ff4d4f' }} />
    });

    // Resetear selección de fila y asiento
    setSelectedRow(null);
    setSelectedSeatNumber(null);
  };

  // Bloquear/Desbloquear sección completa
  const handleToggleSection = (sectionId) => {
    const section = sections.find(s => s.id === sectionId);
    const isCurrentlyBlocked = isSectionBlocked(sectionId);

    onSectionToggle(sectionId);

    notification.success({
      message: isCurrentlyBlocked ? 'Sección desbloqueada' : 'Sección bloqueada',
      description: `${section.name} - ${isCurrentlyBlocked ? 'Ahora disponible' : 'Ahora bloqueada'}`,
      placement: 'topRight',
      icon: isCurrentlyBlocked ? &lt;UnlockOutlined style={{ color: '#52c41a' }} /> : &lt;StopOutlined style={{ color: '#ff4d4f' }} />
    });
  };

  return (
    &lt;div style={{
      padding: '12px',
      maxWidth: '100%',
      width: '100%',
      margin: '0 auto',
      boxSizing: 'border-box',
      overflow: 'hidden'
    }}>
      &lt;Title level={3} style={{
        marginBottom: '16px',
        textAlign: 'center',
        color: COLORS.neutral.darker,
        fontSize: 'clamp(18px, 4vw, 24px)',
        wordWrap: 'break-word'
      }}>
        Control de bloqueo de asientos
      &lt;/Title>

      &lt;Alert
        message="Instrucciones"
        description="Puedes bloquear asientos individuales o secciones completas. Los asientos bloqueados no estarán disponibles para la venta."
        type="info"
        showIcon
        style={{
          marginBottom: '16px',
          fontSize: 'clamp(12px, 2vw, 14px)'
        }}
      />

      {/* Modo de bloqueo */}
      &lt;Card
        style={{
          marginBottom: '16px',
          borderRadius: '12px',
          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
          overflow: 'hidden'
        }}
      >
        &lt;div style={{
          display: 'flex',
          flexDirection: 'column',
          gap: '12px',
          marginBottom: '16px'
        }}>
          &lt;Text strong style={{ fontSize: 'clamp(14px, 3vw, 16px)' }}>Modo de bloqueo:&lt;/Text>
          &lt;Space wrap style={{ justifyContent: 'center' }}>
            &lt;Tag color={blockingMode === 'seat' ? 'blue' : 'default'} style={{ margin: '4px' }}>
              Asientos individuales
            &lt;/Tag>
            &lt;Switch
              checked={blockingMode === 'section'}
              onChange={(checked) => setBlockingMode(checked ? 'section' : 'seat')}
            />
            &lt;Tag color={blockingMode === 'section' ? 'blue' : 'default'} style={{ margin: '4px' }}>
              Secciones completas
            &lt;/Tag>
          &lt;/Space>
        &lt;/div>

        {/* Vista de bloqueo de asientos individuales */}
        {blockingMode === 'seat' &amp;&amp; (
          &lt;Space direction="vertical" size="large" style={{ width: '100%' }}>
            {/* Selector de sección */}
            &lt;div>
              &lt;Text strong style={{ display: 'block', marginBottom: '8px' }}>
                Sección &lt;span style={{ color: '#ff4d4f' }}>*&lt;/span>
              &lt;/Text>
              &lt;Select
                placeholder="Selecciona una sección"
                style={{ width: '100%' }}
                value={selectedSection}
                onChange={handleSectionChange}
                size="large"
              >
                {sections.map(section => (
                  &lt;Option
                    key={section.id}
                    value={section.id}
                  >
                    &lt;div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                      &lt;span>
                        {section.name}
                        {!section.hasNumberedSeats &amp;&amp; ' (Entrada General)'}
                      &lt;/span>
                      {isSectionBlocked(section.id) &amp;&amp; &lt;Tag color="red">Bloqueada&lt;/Tag>}
                    &lt;/div>
                  &lt;/Option>
                ))}
              &lt;/Select>
            &lt;/div>

            {/* Selectores de fila y asiento (solo para asientos numerados) */}
            {currentSection &amp;&amp; currentSection.hasNumberedSeats &amp;&amp; (
              &lt;>
                &lt;div>
                  &lt;Text strong style={{ display: 'block', marginBottom: '8px' }}>
                    Fila &lt;span style={{ color: '#ff4d4f' }}>*&lt;/span>
                  &lt;/Text>
                  &lt;InputNumber
                    placeholder="Número de fila"
                    style={{ width: '100%' }}
                    min={1}
                    max={currentSection.rows}
                    value={selectedRow}
                    onChange={setSelectedRow}
                    size="large"
                  />
                  &lt;Text type="secondary" style={{ fontSize: '12px', display: 'block', marginTop: '4px' }}>
                    Rango válido: 1 - {currentSection.rows}
                  &lt;/Text>
                &lt;/div>

                &lt;div>
                  &lt;Text strong style={{ display: 'block', marginBottom: '8px' }}>
                    Asiento &lt;span style={{ color: '#ff4d4f' }}>*&lt;/span>
                  &lt;/Text>
                  &lt;InputNumber
                    placeholder="Número de asiento"
                    style={{ width: '100%' }}
                    min={1}
                    max={currentSection.seatsPerRow}
                    value={selectedSeatNumber}
                    onChange={setSelectedSeatNumber}
                    size="large"
                  />
                  &lt;Text type="secondary" style={{ fontSize: '12px', display: 'block', marginTop: '4px' }}>
                    Rango válido: 1 - {currentSection.seatsPerRow}
                  &lt;/Text>
                &lt;/div>
              &lt;/>
            )}

            {/* Información de estado */}
            {currentSection &amp;&amp; currentSection.hasNumberedSeats &amp;&amp; selectedRow &amp;&amp; selectedSeatNumber &amp;&amp; (
              &lt;div style={{
                padding: '16px',
                backgroundColor: isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber)
                  ? 'rgba(255, 77, 79, 0.1)'
                  : 'rgba(82, 196, 26, 0.1)',
                borderRadius: '8px',
                marginTop: '8px',
                border: `2px solid ${isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber) ? '#ff4d4f' : '#52c41a'}`
              }}>
                &lt;Space direction="vertical" style={{ width: '100%' }}>
                  &lt;div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                    &lt;Text strong>Estado actual:&lt;/Text>
                    &lt;Tag color={isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber) ? 'red' : 'green'} icon={isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber) ? &lt;LockOutlined /> : &lt;UnlockOutlined />}>
                      {isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber) ? 'BLOQUEADO' : 'DISPONIBLE'}
                    &lt;/Tag>
                  &lt;/div>
                &lt;/Space>
              &lt;/div>
            )}

            {/* Botón bloquear/desbloquear */}
            &lt;Button
              type="primary"
              size="large"
              danger={currentSection &amp;&amp; currentSection.hasNumberedSeats &amp;&amp; selectedRow &amp;&amp; selectedSeatNumber &amp;&amp; !isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber)}
              icon={currentSection &amp;&amp; currentSection.hasNumberedSeats &amp;&amp; selectedRow &amp;&amp; selectedSeatNumber &amp;&amp; isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber) ? &lt;UnlockOutlined /> : &lt;LockOutlined />}
              onClick={handleToggleSeat}
              disabled={!currentSection || (currentSection.hasNumberedSeats &amp;&amp; (!selectedRow || !selectedSeatNumber))}
              block
            >
              {currentSection &amp;&amp; currentSection.hasNumberedSeats &amp;&amp; selectedRow &amp;&amp; selectedSeatNumber &amp;&amp; isSeatBlocked(currentSection.id, selectedRow, selectedSeatNumber)
                ? 'Desbloquear asiento'
                : 'Bloquear asiento'}
            &lt;/Button>
          &lt;/Space>
        )}

        {/* Vista de bloqueo de secciones completas */}
        {blockingMode === 'section' &amp;&amp; (
          &lt;Space direction="vertical" size="middle" style={{ width: '100%' }}>
            &lt;Text type="secondary" style={{ fontSize: '14px' }}>
              Haz clic en una sección para bloquearla o desbloquearla completamente:
            &lt;/Text>

            &lt;div style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(auto-fill, minmax(min(200px, 100%), 1fr))',
              gap: '12px',
              marginTop: '12px',
              width: '100%'
            }}>
              {sections.map(section => {
                const isBlocked = isSectionBlocked(section.id);
                return (
                  &lt;Button
                    key={section.id}
                    size="large"
                    type={isBlocked ? "primary" : "default"}
                    danger={isBlocked}
                    icon={isBlocked ? &lt;UnlockOutlined /> : &lt;LockOutlined />}
                    onClick={() => handleToggleSection(section.id)}
                    style={{
                      borderColor: isBlocked ? '#ff4d4f' : section.color,
                      color: isBlocked ? '#fff' : '#fff',
                      minHeight: '60px',
                      height: 'auto',
                      padding: '8px',
                      whiteSpace: 'normal',
                      wordWrap: 'break-word',
                      ...(isBlocked ? {} : {
                        backgroundColor: section.color
                      })
                    }}
                    block
                  >
                    &lt;div style={{
                      display: 'flex',
                      flexDirection: 'column',
                      alignItems: 'center',
                      gap: '4px',
                      overflow: 'hidden',
                      textOverflow: 'ellipsis'
                    }}>
                      &lt;span style={{
                        fontWeight: 'bold',
                        fontSize: 'clamp(12px, 2.5vw, 14px)',
                        wordWrap: 'break-word',
                        textAlign: 'center'
                      }}>
                        {section.name}
                      &lt;/span>
                      {isBlocked &amp;&amp; (
                        &lt;span style={{
                          fontSize: 'clamp(10px, 2vw, 11px)'
                        }}>
                          (Bloqueada)
                        &lt;/span>
                      )}
                    &lt;/div>
                  &lt;/Button>
                );
              })}
            &lt;/div>
          &lt;/Space>
        )}
      &lt;/Card>

      {/* Resumen de bloqueos */}
      &lt;Card
        title={&lt;span style={{
          fontSize: 'clamp(16px, 3.5vw, 18px)',
          fontWeight: 'bold'
        }}>
          Resumen de bloqueos
        &lt;/span>}
        style={{
          borderRadius: '12px',
          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
          marginTop: '16px',
          overflow: 'hidden'
        }}
      >
        &lt;div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(auto-fit, minmax(min(250px, 100%), 1fr))',
          gap: '16px',
          marginBottom: blockedSections.length > 0 ? '16px' : '0'
        }}>
          &lt;div style={{
            display: 'flex',
            flexDirection: 'column',
            padding: '16px',
            backgroundColor: COLORS.neutral.grey1,
            borderRadius: '8px',
            border: `2px solid ${COLORS.neutral.grey2}`
          }}>
            &lt;Text type="secondary" style={{ marginBottom: '8px' }}>Secciones bloqueadas&lt;/Text>
            &lt;div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
              &lt;Text strong style={{ fontSize: '24px', color: COLORS.neutral.darker }}>
                {blockedSections.length}
              &lt;/Text>
              &lt;Text type="secondary">de {sections.length}&lt;/Text>
            &lt;/div>
          &lt;/div>

          &lt;div style={{
            display: 'flex',
            flexDirection: 'column',
            padding: '16px',
            backgroundColor: COLORS.neutral.grey1,
            borderRadius: '8px',
            border: `2px solid ${COLORS.neutral.grey2}`
          }}>
            &lt;Text type="secondary" style={{ marginBottom: '8px' }}>Asientos bloqueados&lt;/Text>
            &lt;Text strong style={{ fontSize: '24px', color: COLORS.neutral.darker }}>
              {blockedSeats.length}
            &lt;/Text>
          &lt;/div>
        &lt;/div>

        {blockedSections.length > 0 &amp;&amp; (
          &lt;div style={{
            padding: '16px',
            backgroundColor: 'rgba(255, 77, 79, 0.05)',
            borderRadius: '8px',
            border: `1px solid rgba(255, 77, 79, 0.2)`
          }}>
            &lt;Text strong style={{ display: 'block', marginBottom: '12px', color: COLORS.neutral.darker }}>
              Secciones bloqueadas activas:
            &lt;/Text>
            &lt;Space wrap size="small">
              {blockedSections.map(sectionId => {
                const section = sections.find(s => s.id === sectionId);
                return section ? (
                  &lt;Tag
                    key={sectionId}
                    color="red"
                    closable
                    onClose={() => handleToggleSection(sectionId)}
                    style={{ fontSize: '13px', padding: '4px 8px' }}
                  >
                    &lt;LockOutlined /> {section.name}
                  &lt;/Tag>
                ) : null;
              })}
            &lt;/Space>
          &lt;/div>
        )}
      &lt;/Card>
    &lt;/div>
  );
};

export default ManualBlockingSelection;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-components_colorscheme.html">components/colorscheme</a></li><li><a href="module-models_Event.html">models/Event</a></li><li><a href="module-models_Location.html">models/Location</a></li><li><a href="module-models_SeatMap.html">models/SeatMap</a></li><li><a href="module-models_Ticket.html">models/Ticket</a></li><li><a href="module-models_User.html">models/User</a></li><li><a href="module-services_UserService.html">services/UserService</a></li><li><a href="module-utils_api.html">utils/api</a></li><li><a href="module-utils_authSession.html">utils/authSession</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AboutUs">AboutUs</a></li><li><a href="global.html#AdminDashboard">AdminDashboard</a></li><li><a href="global.html#AdminStatistics">AdminStatistics</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#BlockingViewSwitcher">BlockingViewSwitcher</a></li><li><a href="global.html#EditProfile">EditProfile</a></li><li><a href="global.html#EditableSeatRenderer">EditableSeatRenderer</a></li><li><a href="global.html#ErrorPage">ErrorPage</a></li><li><a href="global.html#EventCreation">EventCreation</a></li><li><a href="global.html#EventDetails">EventDetails</a></li><li><a href="global.html#FramedImage">FramedImage</a></li><li><a href="global.html#GeneralAdmissionRenderer">GeneralAdmissionRenderer</a></li><li><a href="global.html#GenericSeatRenderer">GenericSeatRenderer</a></li><li><a href="global.html#HelpCenter">HelpCenter</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#ManualBlockingSelection">ManualBlockingSelection</a></li><li><a href="global.html#ManualSeatSelection">ManualSeatSelection</a></li><li><a href="global.html#Profile">Profile</a></li><li><a href="global.html#Register">Register</a></li><li><a href="global.html#RowPricingTable">RowPricingTable</a></li><li><a href="global.html#SeatMapContainer">SeatMapContainer</a></li><li><a href="global.html#SeatRenderer">SeatRenderer</a></li><li><a href="global.html#SeatSelectionViewSwitcher">SeatSelectionViewSwitcher</a></li><li><a href="global.html#SectionShapeRenderer">SectionShapeRenderer</a></li><li><a href="global.html#SelectionTopBar">SelectionTopBar</a></li><li><a href="global.html#TicketPurchase">TicketPurchase</a></li><li><a href="global.html#VenueStageRenderer">VenueStageRenderer</a></li><li><a href="global.html#ZoomControls">ZoomControls</a></li><li><a href="global.html#enviarEmailConfirmacionCompra">enviarEmailConfirmacionCompra</a></li><li><a href="global.html#generateTicketNumber">generateTicketNumber</a></li><li><a href="global.html#generateToken">generateToken</a></li><li><a href="global.html#generateValidationCode">generateValidationCode</a></li><li><a href="global.html#returnError">returnError</a></li><li><a href="global.html#tokens">tokens</a></li><li><a href="global.html#transporter">transporter</a></li><li><a href="global.html#useAdvancedZoomPan">useAdvancedZoomPan</a></li><li><a href="global.html#useDeviceDetection">useDeviceDetection</a></li><li><a href="global.html#useUserRole">useUserRole</a></li><li><a href="global.html#verifyAdmin">verifyAdmin</a></li><li><a href="global.html#verifyAuthenticated">verifyAuthenticated</a></li><li><a href="global.html#verifyOwnership">verifyOwnership</a></li><li><a href="global.html#verifyPayPalPayment">verifyPayPalPayment</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Thu Nov 13 2025 19:24:33 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
